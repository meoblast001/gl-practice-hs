-- |
-- Module: Programs.PStipple
-- Copyright: (C) 2016 Braden Walters
-- Maintainer: Braden Walters <vc@braden-walters.info>
-- Stability: experimental
-- Portability: ghc

module Programs.PStipple (display, Points.reshape) where

import Foreign.Marshal.Array
import Graphics.GL.Standard21
import Graphics.GL.Types
import Graphics.UI.GLUT.Callbacks.Window
import Graphics.UI.GLUT.Window
import qualified Programs.Points as Points

-- |Called when the frame will be rendered.
display :: DisplayCallback
display = do
  -- Set up the display.
  setupDisplay
  -- Clear colour buffer.
  glClear GL_COLOR_BUFFER_BIT
  -- Draw a stop sign shape as a polygon.
  glBegin GL_POLYGON
  glVertex2f (-20.0) 50.0
  glVertex2f 20.0 50.0
  glVertex2f 50.0 20.0
  glVertex2f 50.0 (-20.0)
  glVertex2f 20.0 (-50.0)
  glVertex2f (-20.0) (-50.0)
  glVertex2f (-50.0) (-20.0)
  glVertex2f (-50.0) 20.0
  glEnd
  -- Render.
  swapBuffers

-- |Sets up the display.
setupDisplay :: IO ()
setupDisplay = do
  -- Background colour is black.
  glClearColor 0.0 0.0 0.0 1.0
  -- Drawing colour is red.
  glColor3f 1.0 0.0 0.0
  -- Enable polygon stippling.
  glEnable GL_POLYGON_STIPPLE
  -- Specify the stipple pattern.
  withArray fireBitmap glPolygonStipple

-- |Bitmap used to draw a campfire.
fireBitmap :: [GLubyte]
fireBitmap =
  [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x01, 0xf0,
   0x00, 0x00, 0x07, 0xf0, 0x0f, 0x00, 0x1f, 0xe0,
   0x1f, 0x80, 0x1f, 0xc0, 0x0f, 0xc0, 0x3f, 0x80,
   0x07, 0xe0, 0x7e, 0x00, 0x03, 0xf0, 0xff, 0x80,
   0x03, 0xf5, 0xff, 0xe0, 0x07, 0xfd, 0xff, 0xf8,
   0x1f, 0xfc, 0xff, 0xe8, 0xff, 0xe3, 0xbf, 0x70,
   0xde, 0x80, 0xb7, 0x00, 0x71, 0x10, 0x4a, 0x80,
   0x03, 0x10, 0x4e, 0x40, 0x02, 0x88, 0x8c, 0x20,
   0x05, 0x05, 0x04, 0x40, 0x02, 0x82, 0x14, 0x40,
   0x02, 0x40, 0x10, 0x80, 0x02, 0x64, 0x1a, 0x80,
   0x00, 0x92, 0x29, 0x00, 0x00, 0xb0, 0x48, 0x00,
   0x00, 0xc8, 0x90, 0x00, 0x00, 0x85, 0x10, 0x00,
   0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00]
